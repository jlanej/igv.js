<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>IGV Variant Review</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>ğŸ§¬ IGV De Novo Variant Review</h1>
        <div id="stats-bar">
            <span id="stat-total">â€“</span> variants |
            <span id="stat-filtered">â€“</span> shown |
            <span class="curation-pass">âœ“ <span id="stat-pass">0</span></span>
            <span class="curation-fail">âœ— <span id="stat-fail">0</span></span>
            <span class="curation-uncertain">? <span id="stat-uncertain">0</span></span>
            <span class="curation-pending">â—‹ <span id="stat-pending">0</span></span>
        </div>
    </header>

    <div id="app">
        <!-- Filter sidebar -->
        <aside id="filter-panel">
            <h2>Filters</h2>
            <div id="filter-controls"></div>
            <div class="filter-actions">
                <button id="btn-apply-filters" class="btn btn-primary">Apply Filters</button>
                <button id="btn-clear-filters" class="btn">Clear All</button>
            </div>
            <div class="filter-actions">
                <button id="btn-save-filters" class="btn btn-sm">ğŸ’¾ Save Filters</button>
                <button id="btn-load-filters" class="btn btn-sm">ğŸ“‚ Load Filters</button>
            </div>
            <hr>
            <h2>Quick Curation</h2>
            <p class="hint">Apply to all selected variants:</p>
            <div class="curation-buttons">
                <button class="btn curation-pass" data-status="pass">âœ“ Pass</button>
                <button class="btn curation-fail" data-status="fail">âœ— Fail</button>
                <button class="btn curation-uncertain" data-status="uncertain">? Uncertain</button>
                <button class="btn" data-status="pending">â—‹ Reset</button>
            </div>
            <hr>
            <h2>Export</h2>
            <button id="btn-export" class="btn">ğŸ“¥ Export TSV</button>
            <button id="btn-export-xlsx" class="btn btn-primary">ğŸ“Š Export XLSX</button>
            <div id="xlsx-progress" style="display:none;">
                <div class="progress-bar"><div class="progress-fill" id="xlsx-progress-fill"></div></div>
                <span id="xlsx-progress-text">Preparingâ€¦</span>
            </div>
        </aside>

        <!-- Main content -->
        <main>
            <!-- Tabs -->
            <div id="tabs">
                <button class="tab active" data-tab="variants">Variant Table</button>
                <button class="tab" data-tab="summary">Gene Summary</button>
                <button class="tab" data-tab="sample-summary">Sample Summary</button>
            </div>

            <!-- Variant table tab -->
            <div id="tab-variants" class="tab-content active">
                <div class="table-controls">
                    <label><input type="checkbox" id="select-all"> Select all on page</label>
                    <span id="page-info"></span>
                    <div class="pagination">
                        <button id="btn-prev" class="btn btn-sm" disabled>â† Prev</button>
                        <button id="btn-next" class="btn btn-sm" disabled>Next â†’</button>
                    </div>
                </div>
                <div id="variant-table-wrap">
                    <table id="variant-table">
                        <thead><tr id="table-header"></tr></thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- Gene summary tab -->
            <div id="tab-summary" class="tab-content">
                <div id="summary-info"></div>
                <div id="summary-table-wrap">
                    <table id="summary-table">
                        <thead>
                            <tr>
                                <th>Gene</th>
                                <th>Total</th>
                                <th>Pass</th>
                                <th>Fail</th>
                                <th>Uncertain</th>
                                <th>Pending</th>
                                <th>Variants</th>
                                <th>Flag Gene</th>
                            </tr>
                        </thead>
                        <tbody id="summary-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- Sample summary tab -->
            <div id="tab-sample-summary" class="tab-content">
                <div id="sample-summary-info"></div>
                <div id="sample-summary-table-wrap">
                    <table id="sample-summary-table">
                        <thead><tr id="sample-summary-header"></tr></thead>
                        <tbody id="sample-summary-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- Resize handle for variant table -->
            <div id="table-resize-handle" title="Drag to resize table"></div>

            <!-- IGV viewer -->
            <div id="igv-section">
                <div id="igv-header">
                    <h2 id="igv-title">Select a variant to view alignments</h2>
                    <div id="igv-curation" style="display:none;">
                        <button class="btn curation-pass" data-status="pass">âœ“ Pass</button>
                        <button class="btn curation-fail" data-status="fail">âœ— Fail</button>
                        <button class="btn curation-uncertain" data-status="uncertain">? Uncertain</button>
                        <textarea id="curation-note" placeholder="Curation noteâ€¦" rows="1"></textarea>
                        <button id="btn-save-note" class="btn btn-sm">Save Note</button>
                    </div>
                </div>
                <div id="igv-div"></div>
                <div id="track-load-status"></div>
            </div>
        </main>
    </div>

    <!-- Keyboard shortcuts help -->
    <button id="shortcuts-toggle" title="Keyboard shortcuts (?)">?</button>
    <div id="shortcuts-panel">
        <h3>Keyboard Shortcuts</h3>
        <div class="shortcut-row"><span>Next uncurated variant</span> <span><kbd>j</kbd> or <kbd>â†“</kbd></span></div>
        <div class="shortcut-row"><span>Prev uncurated variant</span> <span><kbd>k</kbd> or <kbd>â†‘</kbd></span></div>
        <div class="shortcut-row"><span>Mark as Pass</span> <kbd>p</kbd></div>
        <div class="shortcut-row"><span>Mark as Fail</span> <kbd>f</kbd></div>
        <div class="shortcut-row"><span>Mark as Uncertain</span> <kbd>u</kbd></div>
        <div class="shortcut-row"><span>Pass &amp; advance</span> <kbd>P</kbd></div>
        <div class="shortcut-row"><span>Fail &amp; advance</span> <kbd>F</kbd></div>
        <div class="shortcut-row"><span>Uncertain &amp; advance</span> <kbd>U</kbd></div>
        <div class="shortcut-row"><span>Toggle shortcuts</span> <kbd>?</kbd></div>
    </div>

    <script src="app.js"></script>
</body>
</html>
